<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <title>C# Code Sample Page</title>
</head>

<body>
    <div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
        <button id="button1" class="code-copy-button" onclick="CopyToClipboard('cs-code')">Copy</button><pre id="cs-code" style="margin: 0; line-height: 125%"><span style="color: #008800; font-weight: bold">using</span> <span style="color: #0e84b5; font-weight: bold">System</span>;
<span style="color: #008800; font-weight: bold">using</span> <span style="color: #0e84b5; font-weight: bold">System.Collections</span>;
<span style="color: #008800; font-weight: bold">using</span> <span style="color: #0e84b5; font-weight: bold">System.Collections.Generic</span>;

<span style="color: #008800; font-weight: bold">public</span> <span style="color: #008800; font-weight: bold">class</span> <span style="color: #BB0066; font-weight: bold">Program</span>
    {
    <span style="color: #888888">// this will simulate the client calling the new ThirdPartyMailer</span>
    <span style="color: #888888">// via the Adpater</span>
        <span style="color: #008800; font-weight: bold">public</span> <span style="color: #008800; font-weight: bold">static</span> <span style="color: #008800; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">Main</span>(<span style="color: #333399; font-weight: bold">string</span>[] args)
        {
            <span style="color: #333399; font-weight: bold">var</span> mailAdapter = <span style="color: #008800; font-weight: bold">new</span> MailAdapter();
            <span style="color: #888888">//lets send some mail</span>
            <span style="color: #333399; font-weight: bold">var</span> recipients = <span style="color: #008800; font-weight: bold">new</span> List&lt;<span style="color: #333399; font-weight: bold">string</span>&gt;() {
                <span style="background-color: #fff0f0">&quot;michael@somewhere.com&quot;</span>,
                <span style="background-color: #fff0f0">&quot;robert@somewhere.com&quot;</span>,
                <span style="background-color: #fff0f0">&quot;claire@somewhere.com&quot;</span>
            };
            mailAdapter.sendMail(recipients.ToArray(), <span style="background-color: #fff0f0">&quot;An Important Subject!&quot;</span>, <span style="background-color: #fff0f0">&quot;An important message&quot;</span>);
            Console.ReadLine();
        }
    }

<span style="color: #888888">// this is a simplified third party service that has been &quot;updated&quot;</span>
<span style="color: #008800; font-weight: bold">public</span> <span style="color: #008800; font-weight: bold">static</span> <span style="color: #008800; font-weight: bold">class</span> <span style="color: #BB0066; font-weight: bold">ThirdPartyMailer</span> {
    <span style="color: #008800; font-weight: bold">public</span> <span style="color: #008800; font-weight: bold">static</span> <span style="color: #333399; font-weight: bold">bool</span> <span style="color: #0066BB; font-weight: bold">sendSecureMail</span>(<span style="color: #333399; font-weight: bold">string</span> secureToken, <span style="color: #333399; font-weight: bold">string</span>[] recipients, <span style="color: #333399; font-weight: bold">string</span> subject, <span style="color: #333399; font-weight: bold">string</span> body) {
        <span style="color: #888888">// something exciting to send Mail</span>
        Console.WriteLine(<span style="background-color: #fff0f0">&quot;sending a message: {0}, {1} to {2} users&quot;</span>, subject, body, recipients.Length);
        <span style="color: #008800; font-weight: bold">return</span> <span style="color: #008800; font-weight: bold">true</span>;
    }
    <span style="color: #008800; font-weight: bold">public</span> <span style="color: #008800; font-weight: bold">static</span> List&lt;Message&gt; getSecureMail(<span style="color: #333399; font-weight: bold">string</span> secureToken, <span style="color: #333399; font-weight: bold">long</span> accountId) {
        <span style="color: #888888">// something exciting to receive Mail</span>
        <span style="color: #008800; font-weight: bold">return</span> <span style="color: #008800; font-weight: bold">new</span> List&lt;Message&gt;() {
            <span style="color: #008800; font-weight: bold">new</span> <span style="color: #0066BB; font-weight: bold">Message</span>(<span style="background-color: #fff0f0">&quot;bob@home.com&quot;</span>, <span style="background-color: #fff0f0">&quot;Bob&#39;s Subject&quot;</span>, <span style="background-color: #fff0f0">&quot;Bob&#39;s Body text&quot;</span>),
            <span style="color: #008800; font-weight: bold">new</span> <span style="color: #0066BB; font-weight: bold">Message</span>(<span style="background-color: #fff0f0">&quot;mary@home.com&quot;</span>, <span style="background-color: #fff0f0">&quot;Mary&#39;s Subject&quot;</span>, <span style="background-color: #fff0f0">&quot;Mary&#39;s Body text&quot;</span>)
        };
    }
}

<span style="color: #888888">// a basic message class</span>
<span style="color: #008800; font-weight: bold">public</span> <span style="color: #008800; font-weight: bold">class</span> <span style="color: #BB0066; font-weight: bold">Message</span> {
    <span style="color: #008800; font-weight: bold">public</span> <span style="color: #0066BB; font-weight: bold">Message</span>(<span style="color: #333399; font-weight: bold">string</span> sender, <span style="color: #333399; font-weight: bold">string</span> subject, <span style="color: #333399; font-weight: bold">string</span> body) {
        Sender = sender;
        Subject = subject;
        Body = body;
    }
    <span style="color: #008800; font-weight: bold">public</span> <span style="color: #333399; font-weight: bold">string</span> Sender {<span style="color: #008800; font-weight: bold">get</span>;<span style="color: #008800; font-weight: bold">set</span>;}
    <span style="color: #008800; font-weight: bold">public</span> <span style="color: #333399; font-weight: bold">string</span> Subject {<span style="color: #008800; font-weight: bold">get</span>;<span style="color: #008800; font-weight: bold">set</span>;}
    <span style="color: #008800; font-weight: bold">public</span> <span style="color: #333399; font-weight: bold">string</span> Body {<span style="color: #008800; font-weight: bold">get</span>;<span style="color: #008800; font-weight: bold">set</span>;}
}

<span style="color: #888888">// this is the legacy interface that the client expects to use</span>
<span style="color: #008800; font-weight: bold">public</span> <span style="color: #008800; font-weight: bold">interface</span> ILegacyMailer {
    <span style="color: #008800; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">sendMail</span>(<span style="color: #333399; font-weight: bold">string</span>[] recipients, <span style="color: #333399; font-weight: bold">string</span> subject, <span style="color: #333399; font-weight: bold">string</span> body);
    List&lt;Message&gt; getMail(<span style="color: #333399; font-weight: bold">long</span> accountId);
}

<span style="color: #888888">// the adapter class that allows the client to communicate with the new</span>
<span style="color: #888888">// Third Party Mailer Service</span>
<span style="color: #008800; font-weight: bold">public</span> <span style="color: #008800; font-weight: bold">class</span> <span style="color: #BB0066; font-weight: bold">MailAdapter</span>: ILegacyMailer {
    <span style="color: #008800; font-weight: bold">private</span> <span style="color: #333399; font-weight: bold">string</span> _secureToken = <span style="background-color: #fff0f0">&quot;SUPER_SECURITY&quot;</span>;
    <span style="color: #008800; font-weight: bold">public</span> <span style="color: #008800; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">sendMail</span>(<span style="color: #333399; font-weight: bold">string</span>[] recipients, <span style="color: #333399; font-weight: bold">string</span> subject, <span style="color: #333399; font-weight: bold">string</span> body) {
        <span style="color: #888888">// this is simple mapping logic from the old call to the new service format</span>
        ThirdPartyMailer.sendSecureMail(_secureToken, recipients, subject, body);
    }
    <span style="color: #008800; font-weight: bold">public</span> List&lt;Message&gt; getMail(<span style="color: #333399; font-weight: bold">long</span> accountId) {
        <span style="color: #888888">// this is simple mapping logic from the old call to the new service format</span>
        <span style="color: #008800; font-weight: bold">return</span> ThirdPartyMailer.getSecureMail(_secureToken, accountId);
    }
}
</pre></div>


</body>

</html>